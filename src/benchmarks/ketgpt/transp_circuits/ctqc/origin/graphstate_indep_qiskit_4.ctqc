H 0
H 1
H 1
CNOT 0 1
H 1
H 2
H 2
CNOT 1 2
H 2
H 3
H 3
CNOT 0 3
H 3
H 3
CNOT 2 3
H 3
M 0
M 1
M 2
M 3